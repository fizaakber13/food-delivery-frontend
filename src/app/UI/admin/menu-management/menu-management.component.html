<div [@fadeSlideDown]>
  <div class="menu-box">
    
    <input
      type="text"
      class="search-box"
      placeholder="Search for restaurant or menu item"
      [(ngModel)]="searchText" />

    <div class="restaurant-list">
      <div *ngFor="let restaurant of getFilteredRestaurants()">
        <div class="restaurant-item">
          <div class="restaurant-header">
            <div class="restaurant-info">
              <strong>{{ restaurant.name }}</strong>
            </div>
            <div class="restaurant-actions">
              <button class="add-menu-btn" (click)="openAddMenuModal(restaurant.id)"> + Add Menu Items</button>
              <button class="dropdown-btn" [class.open]="expandedRestaurantId === restaurant.id" (click)="toggleExpand(restaurant.id)">▼</button>
            </div>
          </div>

          <div *ngIf="expandedRestaurantId === restaurant.id" class="restaurant-menu-items">
            <ul class="menu-list">
              <li *ngFor="let item of getMenuItemsForRestaurant(restaurant.id)">
                <div class="menu-item">
                  <div class="menu-item-details">
                    <strong>{{ item.name }}</strong>
                    <span> | {{ item.category }} | ₹{{ item.price }} | ⭐ {{ item.rating }}</span>
                    <p>{{ item.description }}</p>
                  </div>
                  <div class="action-buttons">
                    <button (click)="editMenuItem(item)" class="edit-btn">✏️ Edit</button>
                    <button (click)="confirmDeleteMenuItem(item.id)" class="delete-btn">❌ Delete</button>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Add/Edit Modal -->
    <div class="modal" *ngIf="showAddModal">
      <div class="modal-content">
        <h3>{{ editMode ? 'Edit' : 'Add' }} Menu Item</h3>

        <form #form="ngForm" (ngSubmit)="addOrUpdateMenuItem()">
          <input
            [(ngModel)]="newItem.name"
            name="name"
            placeholder="Item Name"
            required />

          <input
            [ngModel]="newItem.rating === 0 ? '' : newItem.rating"
            (ngModelChange)="newItem.rating = $event"
            name="rating"
            type="number"
            min="1"
            max="5"
            step="0.1"
            placeholder="Enter rating (1-5)"
            required />

          <input
            [(ngModel)]="newItem.category"
            name="category"
            placeholder="Category"
            required />

          <input
            [ngModel]="newItem.price === 0 ? '' : newItem.price"
            (ngModelChange)="newItem.price = $event"
            name="price"
            type="number"
            placeholder="Enter price in rupees"
            required />

          <textarea
            [(ngModel)]="newItem.description"
            name="description"
            placeholder="Description"
            required></textarea>

          <button type="submit" [disabled]="form.invalid">
            {{ editMode ? 'Update' : 'Add' }}
          </button>
          <button type="button" class="close-btn" (click)="closeModal()">Cancel</button>
        </form>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" *ngIf="showDeleteConfirm">
      <div class="modal-content">
        <h3>Confirm Delete</h3>
        <p>Are you sure you want to delete this menu item?</p>
        <div class="confirm-buttons">
          <button (click)="deleteMenuItem()">Yes</button>
          <button class="close-btn" (click)="cancelDelete()">No</button>
        </div>
      </div>
    </div>
  </div>
</div>
